<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BIOME4 · Biome.jl</title><meta name="title" content="BIOME4 · Biome.jl"/><meta property="og:title" content="BIOME4 · Biome.jl"/><meta property="twitter:title" content="BIOME4 · Biome.jl"/><meta name="description" content="Documentation for Biome.jl."/><meta property="og:description" content="Documentation for Biome.jl."/><meta property="twitter:description" content="Documentation for Biome.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/pfts/pfts.css" rel="stylesheet" type="text/css"/><script src="../assets/pfts/pfts.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Biome.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Biome.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../getting-started/">-</a></li><li><a class="tocitem" href="../model-setup/">Model Setup — BiomeDriver</a></li><li><a class="tocitem" href="../data/">Data</a></li></ul></li><li><a class="tocitem" href="../pfts/">Plant Functional Types</a></li><li><a class="tocitem" href="../pft_database/">PFT Database</a></li><li><a class="tocitem" href="../biomes/">Biomes</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Climate Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../koppen/">Koppen-Geiger</a></li><li><a class="tocitem" href="../thornthwaite/">Thornthwaite</a></li><li><a class="tocitem" href="../trollpfaffen/">Troll-Pfaffen</a></li><li><a class="tocitem" href="../wissmann/">Wissmann</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox" checked/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Mechanistic Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>BIOME4</a><ul class="internal"><li><a class="tocitem" href="#1)-Original-BIOME4"><span>1) Original BIOME4</span></a></li><li><a class="tocitem" href="#2)-Dominance-mode-(modified-competition)"><span>2) Dominance-mode (modified competition)</span></a></li><li><a class="tocitem" href="#What’s-different-in-competition?"><span>What’s different in competition?</span></a></li><li><a class="tocitem" href="#Inputs-—-recap-(mechanistic-modes)"><span>Inputs — recap (mechanistic modes)</span></a></li><li><a class="tocitem" href="#Output-variables-(NetCDF)"><span>Output variables (NetCDF)</span></a></li><li><a class="tocitem" href="#Minimal-troubleshooting"><span>Minimal troubleshooting</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li><a class="is-disabled">Mechanistic Model</a></li><li class="is-active"><a href>BIOME4</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>BIOME4</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/clechartre/Biome.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/clechartre/Biome.jl/blob/master/docs/src/biome4.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="BIOME4"><a class="docs-heading-anchor" href="#BIOME4">BIOME4</a><a id="BIOME4-1"></a><a class="docs-heading-anchor-permalink" href="#BIOME4" title="Permalink"></a></h1><p><img src="../assets/output_b4.svg" alt="BIOME4 example"/></p><p><strong>Figure.</strong> Example BIOME4-famil| Step | Original BIOME4 | Dominance-mode (Biome.jl) | |–-|–-|–-| | 3. Competition | Rule-based comparisons of woody vs. grass PFTs using thresholds on LAI, NPP, fire/greendays, and hand-crafted switches (e.g., temperate evergreen vs. cool conifer; woody-desert fallback; tundra shrub vs. cold herb). | Continuous <strong>scored ranking</strong>: climate-space dominance (Gaussian proximity to each PFT&#39;s optima for <code>clt/temp/prec</code>) × NPP × (1 / <code>dominance_factor</code>). Highest score wins; subdominants retained for mixed states. |utput. The NetCDF typically contains <code>biome</code> (class id), <code>optpft</code> (dominant PFT id), and <code>npp</code> (per-PFT) on the model grid.</p><p>We offer two ways to run the BIOME4 logic:</p><hr/><h2 id="1)-Original-BIOME4"><a class="docs-heading-anchor" href="#1)-Original-BIOME4">1) Original BIOME4</a><a id="1)-Original-BIOME4-1"></a><a class="docs-heading-anchor-permalink" href="#1)-Original-BIOME4" title="Permalink"></a></h2><p>This path follows an exact translation of the original BIOME core (Haxeltine &amp; Prentice; Kaplan &amp; Prentice). The original Fortran sources by Jed O. Kaplan are available at: https://github.com/jedokaplan/BIOME4</p><h3 id="Inputs-(climatologies;-aligned-grids)"><a class="docs-heading-anchor" href="#Inputs-(climatologies;-aligned-grids)">Inputs (climatologies; aligned grids)</a><a id="Inputs-(climatologies;-aligned-grids)-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs-(climatologies;-aligned-grids)" title="Permalink"></a></h3><ul><li><strong>Temperature (<code>temp</code>)</strong>: °C, monthly means (stacked in the 3rd dimension)  </li><li><strong>Precipitation (<code>prec</code>)</strong>: mm month⁻¹, monthly sums/means (consistent with your decision tree)  </li><li><strong>Sun/Cloud (<code>sun</code> or <code>clt</code>)</strong>: % (sunshine or cloudiness surrogate)  </li><li><strong>Soils (<code>Ksat</code>, <code>whc</code>)</strong>: saturated conductivity (mm h⁻¹) and water-holding capacity (mm cm⁻¹)  </li><li><strong>CO₂</strong>: a single ppm value representative of the climatology period  </li><li><strong>PFT list</strong>: default BIOME4 PFTs, or a customized list</li></ul><h3 id="Outputs"><a class="docs-heading-anchor" href="#Outputs">Outputs</a><a id="Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs" title="Permalink"></a></h3><ul><li><code>biome (lon,lat)</code>: BIOME4 biome id (Kaplan &amp; Prentice mapping)  </li><li><code>optpft (lon,lat)</code>: id of dominant PFT  </li><li><code>npp (lon,lat,pft)</code>: annual NPP per PFT (same order as <code>pftlist</code>)</li></ul><p><strong>Notes</strong></p><ul><li>Ensure all rasters share the same grid/extent and monthly stacking.  </li><li>Units: temp = °C; prec = mm month⁻¹; sun/clt = %; Ksat = mm h⁻¹; WHC = mm cm⁻¹.  </li><li>CO₂ should match the climatology-period mean.</li></ul><hr/><h2 id="2)-Dominance-mode-(modified-competition)"><a class="docs-heading-anchor" href="#2)-Dominance-mode-(modified-competition)">2) Dominance-mode (modified competition)</a><a id="2)-Dominance-mode-(modified-competition)-1"></a><a class="docs-heading-anchor-permalink" href="#2)-Dominance-mode-(modified-competition)" title="Permalink"></a></h2><p>This mode keeps the BIOME4 physiology (environmental sieve → LAI &amp; NPP per PFT) but <strong>modifies the competition</strong> step to rank PFTs by <strong>climate-space dominance</strong> plus productivity.</p><h3 id="Rationale-(dominance-envelope)"><a class="docs-heading-anchor" href="#Rationale-(dominance-envelope)">Rationale (dominance envelope)</a><a id="Rationale-(dominance-envelope)-1"></a><a class="docs-heading-anchor-permalink" href="#Rationale-(dominance-envelope)" title="Permalink"></a></h3><p>For each PFT and each climate variable (cloudiness, precipitation, temperature), we define an optimum and spread (fitted as a Gaussian in the PFT&#39;s observed/climatological niche). For a pixel value <span>$x_v$</span> and variable <span>$v ∈ {clt, temp, prec}$</span>, we compute a standardized dominance contribution:</p><p class="math-container">\[\mathrm{dom}_v = \exp\!\left(-\frac{(x_v - \mu_{\mathrm{PFT},v})^2}{2\,\sigma_{\mathrm{PFT},v}^2}\right)\]</p><p>Then sum (or weight/sum) across variables:</p><p class="math-container">\[\text{dominance\_environment} = \mathrm{dom}_{\text{clt}} + \mathrm{dom}_{\text{temp}} + \mathrm{dom}_{\text{prec}}\]</p><p>Finally, combine climate dominance with productivity and a PFT-specific <span>$\text{dominance\_factor}$</span>:</p><p class="math-container">\[\mathrm{score}_{\mathrm{PFT}} = \text{dominance\_environment}\times \mathrm{NPP}_{\mathrm{PFT}} \times \frac{1}{\text{dominance\_factor}_{\mathrm{PFT}}}\]</p><p>The PFT with the highest score is the dominant (<strong>optpft</strong>). Woody and grass subdominants are tracked for mixed cases.</p><h3 id="Outputs-2"><a class="docs-heading-anchor" href="#Outputs-2">Outputs</a><a class="docs-heading-anchor-permalink" href="#Outputs-2" title="Permalink"></a></h3><p>Same schema as the original mode (<code>biome</code>, <code>optpft</code>, <code>npp</code>).   The <strong>biome</strong> is still assigned using the BIOME4 PFT→biome mapping after dominance is chosen.</p><hr/><h2 id="What’s-different-in-competition?"><a class="docs-heading-anchor" href="#What’s-different-in-competition?">What’s different in competition?</a><a id="What’s-different-in-competition?-1"></a><a class="docs-heading-anchor-permalink" href="#What’s-different-in-competition?" title="Permalink"></a></h2><p>At a high level, both modes:</p><ol><li><strong>Sieve PFTs</strong> by physiological constraints (e.g., <code>tmin</code>, <code>gdd5/gdd0</code>, <code>tcm</code>, <code>twm</code>, snow, soil water balance).  </li><li>Compute <strong>LAI</strong> and <strong>NPP</strong> for all surviving PFTs.</li></ol><p>They diverge at step (3):</p><table><tr><th style="text-align: right">Step</th><th style="text-align: right">Original BIOME4</th><th style="text-align: right">Dominance-mode (Biome.jl)</th></tr><tr><td style="text-align: right">3. Competition</td><td style="text-align: right">Rule-based comparisons of woody vs. grass PFTs using thresholds on LAI, NPP, fire/greendays, and hand-crafted switches (e.g., temperate evergreen vs. cool conifer; woody-desert fallback; tundra shrub vs. cold herb).</td><td style="text-align: right">Continuous <strong>scored ranking</strong>: climate-space dominance (Gaussian proximity to each PFT’s optima for <code>clt/temp/prec</code>) × NPP × (1 / <code>dominance_factor</code>). Highest score wins; subdominants retained for mixed states.</td></tr></table><p>This preserves BIOME4’s physiology and the environmental sieve, while replacing the final “if/else” winner logic with a continuous dominance score—making it easier to extend to custom PFT sets without rewriting many rule branches.</p><hr/><h2 id="Inputs-—-recap-(mechanistic-modes)"><a class="docs-heading-anchor" href="#Inputs-—-recap-(mechanistic-modes)">Inputs — recap (mechanistic modes)</a><a id="Inputs-—-recap-(mechanistic-modes)-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs-—-recap-(mechanistic-modes)" title="Permalink"></a></h2><ul><li><strong>Required rasters</strong>: <code>temp</code>, <code>prec</code> (monthly stacks); typically also <code>clt/sun</code>, <code>Ksat</code>, <code>whc</code>.  </li><li><strong>CO₂</strong>: single ppm value representative of your climatology period.  </li><li><strong>PFT list</strong>: defaults to <code>BIOME4.PFTClassification()</code>; parameters/constraints can be customized.</li></ul><p><strong>Grid alignment is critical</strong>: all rasters must share the same <code>X/Y</code> grid and time stacking. Missing values are normalized internally to <code>-9999.0</code>.</p><hr/><h2 id="Output-variables-(NetCDF)"><a class="docs-heading-anchor" href="#Output-variables-(NetCDF)">Output variables (NetCDF)</a><a id="Output-variables-(NetCDF)-1"></a><a class="docs-heading-anchor-permalink" href="#Output-variables-(NetCDF)" title="Permalink"></a></h2><ul><li>Coordinates: <code>lon</code>, <code>lat</code>  </li><li><strong>Mechanistic schema</strong>  <ul><li><code>biome :: Int16</code> — BIOME4 biome id  </li><li><code>optpft :: Int16</code> — dominant PFT id  </li><li><code>npp :: Float64</code> — shape <code>(lon, lat, pft)</code>; includes <code>num_pfts + 1</code> slots (default/mixed)</li></ul></li></ul><p>Keep a sidecar legend for <strong>PFT id → name</strong> and <strong>biome id → label</strong> used in your plots.</p><hr/><h2 id="Minimal-troubleshooting"><a class="docs-heading-anchor" href="#Minimal-troubleshooting">Minimal troubleshooting</a><a id="Minimal-troubleshooting-1"></a><a class="docs-heading-anchor-permalink" href="#Minimal-troubleshooting" title="Permalink"></a></h2><ul><li><strong>Flat/missing output</strong>: check raster alignment/units; inspect the min/max debug prints in the driver.  </li><li><strong>Everything “NA”</strong>: verify units and that monthly stacks are on the 3rd dimension.  </li><li><strong>Resume quirks</strong>: the driver skips rows where the primary variable (<code>biome</code>) already holds non-fill values; remove/rename the outfile to force a clean run.</li></ul><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Haxeltine, A., &amp; Prentice, I. C. (1996). <em>BIOME3: An equilibrium terrestrial biosphere model based on ecophysiological constraints, resource availability, and competition among plant functional types.</em> Global Biogeochemical Cycles, 10(4), 693–709.  </li><li>Kaplan, J., &amp; Prentice, I. (2001). <em>Geophysical Applications of Vegetation Modeling.</em>  </li><li>Prentice, I. C., Cramer, W., Harrison, S. P., Leemans, R., Monserud, R. A., &amp; Solomon, A. M. (1992). <em>A Global Biome Model Based on Plant Physiology and Dominance, Soil Properties and Climate.</em> Journal of Biogeography, 19(2), 117–134.  </li><li>BIOME4 Fortran sources: https://github.com/jedokaplan/BIOME4</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../wissmann/">« Wissmann</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 30 January 2026 10:42">Friday 30 January 2026</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
